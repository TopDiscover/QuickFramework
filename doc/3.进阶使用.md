# protobufjs 使用

参考链接: https://docs.cocos.com/creator/manual/zh/scripting/modules/example.html#%E6%A1%88%E4%BE%8B%E4%B8%80%EF%BC%9Aprotobufjs-%E4%BD%BF%E7%94%A8

## 1，安装[protobufjs](https://www.npmjs.com/package/protobufjs)包

在项目目录下打开终端，执行 npm i protobufjs。如果这个项目属于多人协作，甚至可以把 protobufjs 这个包作为依赖写入 package.json，通过在上述命名行里加入 npm install --save protobufjs 即可利用命令行自动写入到 package.json 中。执行完之后，就可以在项目录下的 node_module 文件夹里查找到 protobufjs 相关文件夹。

## 2，安装命令行工具
在项目目录下打开终端，执行npm install protobufjs-cli

## 3，配置生成JS命令到package.json中
node ./node_modules/protobufjs-cli/bin/pbjs --dependency protobufjs/minimal.js --target static-module --wrap commonjs --out ./@types/Proto.js ./assets/bundles/hall/proto/userInfo.proto ./assets/bundles/hall/proto/roomInfo.proto

## 4,配置生成声明文件命令到package.json中
node ./node_modules/protobufjs-cli/bin/pbts -o ./@types/Proto.d.ts ./@types/Proto.js

## 5，生成proto声明文件
依次执行:
npm run build-proto:pbjs
npm run build-proto:pbts